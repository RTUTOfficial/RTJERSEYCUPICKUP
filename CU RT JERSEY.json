{"files":[{"id":"0b27ed9f-ee91-4acb-b4ef-2f82fdb26215","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Bangkok\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"73ecae59-92ba-444b-9326-bb0cfe83034f","name":"รหัส","type":"server_js","source":"const SPREADSHEET_ID \u003d \u00271u0gyl_DIz9ygj6wgyBE609QHNQwFIh7pu4WK81s1pKc\u0027; // ใส่ ID ของ Google Sheets\nconst SHEET_NAME \u003d \u0027order\u0027; // ชื่อชีทใน Google Sheets\n\n// ฟังก์ชัน Web App ที่แสดง HTML หน้าเว็บ\nfunction doGet() {\n  return HtmlService.createHtmlOutputFromFile(\u0027index\u0027);\n}\n\n// ฟังก์ชันค้นหาข้อมูลใน Google Sheets\nfunction searchData(query) {\n  const sheet \u003d SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName(SHEET_NAME);\n  const data \u003d sheet.getDataRange().getValues();\n  \n  for (let i \u003d 1; i \u003c data.length; i++) {\n    if (data[i].join(\u0027 \u0027).includes(query)) {  // ค้นหาข้อความในทุกคอลัมน์\n      return { row: i + 1, name: data[i][1], phone: data[i][0], product: data[i][2] };\n    }\n  }\n  return { error: \"ไม่พบข้อมูลที่ตรงกับคำค้นหา\" };\n}\n\n// ฟังก์ชันบันทึกวันที่นัดรับและสถานที่\nfunction savePickupDetails(row, date, location) {\n  const sheet \u003d SpreadsheetApp.openById(SPREADSHEET_ID).getSheetByName(SHEET_NAME);\n  sheet.getRange(Number(row), 4).setValue(date);    // บันทึกวันที่นัดรับในคอลัมน์ที่ 4\n  sheet.getRange(Number(row), 5).setValue(location); // บันทึกสถานที่นัดรับในคอลัมน์ที่ 5\n  return { success: true, message: \"บันทึกวันที่และสถานที่สำเร็จ\" };\n}\n"},{"id":"be5416ff-8c96-42b7-866d-6b0806c65f20","name":"index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml lang\u003d\"en\"\u003e\n\u003chead\u003e\n  \u003cmeta charset\u003d\"UTF-8\"\u003e\n  \u003cmeta name\u003d\"viewport\" content\u003d\"width\u003ddevice-width, initial-scale\u003d1.0\"\u003e\n  \u003ctitle\u003eRADTECH JERSEY : CU PICKUP\u003c/title\u003e\n  \u003cstyle\u003e\n    body {\n      font-family: Arial, sans-serif;\n      background-image: url(\u0027https://drive.google.com/file/d/1isgA4kEDtsDaX2OedP-dONZ1d9J9mip9\u0027);\n      background-size: cover;\n      color: #1a1c27;\n      text-align: center;\n      margin: 0;\n      padding: 0;\n    }\n    .container {\n      background-color: rgba(255, 255, 255, 0.8);\n      width: 80%;\n      max-width: 600px;\n      margin: 50px auto;\n      padding: 20px;\n      border-radius: 10px;\n      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);\n    }\n    h1 {\n      color: #1a1c27;\n    }\n    input, select, button {\n      width: 80%;\n      margin: 10px 0;\n      padding: 10px;\n      border-radius: 5px;\n      border: 1px solid #ddd;\n    }\n    button {\n      background-color: #1a1c27;\n      color: white;\n      border: none;\n      cursor: pointer;\n    }\n    button:hover {\n      background-color: #727bab;\n    }\n    .logo {\n      width: 100px;\n      margin-bottom: 20px;\n    }\n  \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n  \u003cdiv class\u003d\"container\"\u003e\n    \u003cimg src\u003d\"https://drive.google.com/file/d/1mZDBcTEqUYaeWhCWGO8jByk0aaqY6vGm\" alt\u003d\"Logo\" class\u003d\"logo\"\u003e\n    \u003ch1\u003eRADTECH JERSEY : CU PICKUP\u003c/h1\u003e\n    \u003cinput type\u003d\"text\" id\u003d\"query\" placeholder\u003d\"กรอกคำค้นหา (ชื่อหรือเบอร์โทร)\"\u003e\n    \u003cbutton onclick\u003d\"searchData()\"\u003eค้นหา\u003c/button\u003e\n    \u003cdiv id\u003d\"result\"\u003e\u003c/div\u003e\n    \u003cdiv id\u003d\"dateSection\" style\u003d\"display:none;\"\u003e\n      \u003ch3\u003eเลือกสถานที่นัดรับ\u003c/h3\u003e\n      \u003cselect id\u003d\"pickupLocation\" onchange\u003d\"updateAvailableDates()\"\u003e\n        \u003coption value\u003d\"\"\u003e-- กรุณาเลือกสถานที่ --\u003c/option\u003e\n        \u003coption value\u003d\"คณะสหเวชศาสตร์ จุฬาฯ\"\u003eคณะสหเวชศาสตร์ จุฬาฯ(17:00 - 18:00 น.)\u003c/option\u003e\n        \u003coption value\u003d\"โรงพยาบาลจุฬาฯ\"\u003eโรงพยาบาลจุฬาฯ(16:30 - 17:30 น.)\u003c/option\u003e\n        \u003coption value\u003d\"อื่นๆ\"\u003eอื่นๆ (โปรดติดต่อ ig : RTCU.Official ก่อนเลือกจุดรับนี้)\u003c/option\u003e\n      \u003c/select\u003e\n      \u003ch3\u003eเลือกวันที่นัดรับสินค้า\u003c/h3\u003e\n      \u003cselect id\u003d\"pickupDate\"\u003e\n        \u003coption value\u003d\"\"\u003e-- กรุณาเลือกวันที่ --\u003c/option\u003e\n      \u003c/select\u003e\n      \u003cbutton onclick\u003d\"saveDate()\"\u003eบันทึกวันที่และสถานที่\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\n  \u003cscript\u003e\n    let selectedRow \u003d null;\n\n    // ตัวอย่างวันที่ตามสถานที่\n    const locationDates \u003d {\n      \"คณะสหเวชศาสตร์ จุฬาฯ\": [\"2025-JAN-06\", \"2025-JAN-07\", \"2025-JAN-08\"],\n      \"โรงพยาบาลจุฬาฯ\": [\"2024-DEC-17\" , \"2025-JAN-02\", \"2025-JAN-03\", \"2025-JAN-05\"],\n      \"อื่นๆ\": []\n    };\n\n    function searchData() {\n      const query \u003d document.getElementById(\u0027query\u0027).value;\n      if (!query) {\n        alert(\u0027กรุณากรอกคำค้นหา\u0027);\n        return;\n      }\n      google.script.run.withSuccessHandler(displayResult).searchData(query);\n    }\n\n    function displayResult(data) {\n      const resultDiv \u003d document.getElementById(\u0027result\u0027);\n      if (data.error) {\n        resultDiv.innerHTML \u003d `\u003cp style\u003d\"color: red;\"\u003e${data.error}\u003c/p\u003e`;\n        document.getElementById(\u0027dateSection\u0027).style.display \u003d \u0027none\u0027;\n      } else {\n        selectedRow \u003d data.row;\n        resultDiv.innerHTML \u003d `\n          \u003cp\u003e\u003cstrong\u003eเบอร์โทร:\u003c/strong\u003e ${data.name}\u003c/p\u003e\n          \u003cp\u003e\u003cstrong\u003eชื่อ:\u003c/strong\u003e ${data.phone}\u003c/p\u003e\n          \u003cp\u003e\u003cstrong\u003eสินค้าที่สั่ง:\u003c/strong\u003e ${data.product}\u003c/p\u003e\n        `;\n        document.getElementById(\u0027dateSection\u0027).style.display \u003d \u0027block\u0027;\n      }\n    }\n\n    function updateAvailableDates() {\n      const location \u003d document.getElementById(\u0027pickupLocation\u0027).value;\n      const dateSelect \u003d document.getElementById(\u0027pickupDate\u0027);\n      dateSelect.innerHTML \u003d \u0027\u003coption value\u003d\"\"\u003e-- กรุณาเลือกวันที่ --\u003c/option\u003e\u0027; // Reset options\n\n      if (locationDates[location]) {\n        locationDates[location].forEach(date \u003d\u003e {\n          const option \u003d document.createElement(\u0027option\u0027);\n          option.value \u003d date;\n          option.textContent \u003d new Date(date).toLocaleDateString(\u0027th-TH\u0027);\n          dateSelect.appendChild(option);\n        });\n      }\n\n      if (location \u003d\u003d\u003d \"อื่นๆ\") {\n        alert(\"โปรดติดต่อ ig : RTCU.Official ก่อนเลือกจุดรับนี้\");\n      }\n    }\n\n    function saveDate() {\n      const date \u003d document.getElementById(\u0027pickupDate\u0027).value;\n      const location \u003d document.getElementById(\u0027pickupLocation\u0027).value;\n      if (!date || !location) {\n        alert(\u0027กรุณาเลือกสถานที่และวันที่\u0027);\n        return;\n      }\n      google.script.run.withSuccessHandler(response \u003d\u003e {\n        alert(response.message);\n      }).savePickupDetails(selectedRow, date, location);\n    }\n  \u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n\n"}]}